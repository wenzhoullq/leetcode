## 题目

给你一个只包含 `'('` 和 `')'` 的字符串，找出最长有效（格式正确且连续）括号子串的长度。

## 思路

 很容易想到是`动态规划`，情况就是这两种： 下标为 i 碰到）时，检查i-1是否为（ ，如果是那么就+2，并且`在此基础上`继续检查 i-2是否为有长度，如果有就加；如果i-1为 ) ,检查它i-dp[i-1]-1是否为（,是的话加，并且`在此基础上`继续检查i-dp[i-1]-2是否有长度

```java
class Solution {
    public int longestValidParentheses(String s) {
        int[] dp=new int[s.length()];
        int max=0;
        for(int i=1;i<s.length();i++){//细节从i=1开始
            if(s.charAt(i)==')'){
                if(s.charAt(i-1)=='(') {
                    dp[i]=2;
                    if(i>2&&s.charAt(i-2)==')') dp[i]+=dp[i-2];//这里的if是嵌套进去的
                }
                else {
                    if(i-dp[i-1]-1>=0&&s.charAt(i-dp[i-1]-1)=='(') {
                        dp[i]+=dp[i-1]+2;
                        if(i-dp[i-1]-1>0) dp[i]+=dp[i-dp[i-1]-2];//这里的if是嵌套进去的
                    }
                }
              max=Math.max(max,dp[i]);  
            }
        }   
        return max;
    }
}
```

